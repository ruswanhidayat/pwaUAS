const header=document.getElementById("root"),logo=document.createElement("img"),cont=document.createElement("div"),tableNas=document.getElementById("tnas"),rowNas=document.createElement("tr"),tableProv=document.getElementById("tprov"),perProv="https://services5.arcgis.com/VS6HdKS0VfIhv8Ct/arcgis/rest/services/COVID19_Indonesia_per_Provinsi/FeatureServer/0/query?where=FID%20%3E%3D%201%20AND%20FID%20%3C%3D%2034&outFields=Provinsi,Kasus_Posi,Kasus_Semb,Kasus_Meni,FID&returnGeometry=false&returnDistinctValues=true&orderByFields=FID&outSR=4326&f=json",kumHarian="https://services5.arcgis.com/VS6HdKS0VfIhv8Ct/arcgis/rest/services/Statistik_Perkembangan_COVID19_Indonesia/FeatureServer/0/query?where=1%3D1&outFields=Jumlah_Kasus_Kumulatif,Jumlah_Pasien_Sembuh,Jumlah_Pasien_Meninggal,Jumlah_pasien_dalam_perawatan,Tanggal,Jumlah_Kasus_Baru_per_Hari&returnGeometry=false&orderByFields=Tanggal&outSR=4326&f=json";let globalVar;function getShortDate(e){var t=new Date(e),a=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0");return t.getDate().toString().padStart(2,"0")+"/"+n+"/"+a}logo.src="https://cdn.glitch.com/e52c8aff-aeae-49cc-88d6-ec810914178b%2Fimage-min.png?v=1593705089551",logo.setAttribute("alt",""),cont.setAttribute("class","container"),header.appendChild(logo),header.appendChild(cont),fetch(kumHarian).then(e=>e.json()).then(e=>{let t=e.features,a=0,n=0;for(var r=0;r<t.length;r++){var s=parseInt(t[r].attributes.Jumlah_Kasus_Kumulatif,10);s>a&&(a=s,n=r)}globalVar=t[n];let i=document.createElement("div"),l=document.createElement("h1"),u=document.createElement("p");i.setAttribute("class","card card1"),l.innerHTML=`${t[n].attributes.Jumlah_Kasus_Kumulatif}`,u.innerHTML="Konfirmasi Positif",cont.appendChild(i),i.appendChild(l),i.appendChild(u);let d=document.createElement("div"),o=document.createElement("h1"),c=document.createElement("p");d.setAttribute("class","card card2"),o.innerHTML=`${t[n].attributes.Jumlah_Pasien_Meninggal}`,c.innerHTML="Pasien Meninggal",cont.appendChild(d),d.appendChild(o),d.appendChild(c);let m=document.createElement("div"),p=document.createElement("h1"),h=document.createElement("p");m.setAttribute("class","card card3"),p.innerHTML=`${t[n].attributes.Jumlah_Pasien_Sembuh}`,h.innerHTML="Pasien Sembuh",cont.appendChild(m),m.appendChild(p),m.appendChild(h);let b=document.createElement("div"),g=document.createElement("h1"),_=document.createElement("p");b.setAttribute("class","card card4"),g.innerHTML=`${t[n].attributes.Jumlah_pasien_dalam_perawatan}`,_.innerHTML="Kasus Aktif",cont.appendChild(b),b.appendChild(g),b.appendChild(_);let f=document.createElement("small");f.innerHTML=`Data per ${getShortDate(t[n].attributes.Tanggal)}, Sumber: bnpb-inacovid19`,cont.appendChild(f),tableNas.appendChild(rowNas);let C=document.createElement("td"),E=document.createElement("td"),v=document.createElement("td"),K=document.createElement("td");C.innerHTML="Indonesia (Nasional)",E.innerHTML=`${t[n].attributes.Jumlah_Kasus_Kumulatif}`,v.innerHTML=`${t[n].attributes.Jumlah_Pasien_Sembuh}`,K.innerHTML=`${t[n].attributes.Jumlah_Pasien_Meninggal}`,C.setAttribute("class","prov"),E.setAttribute("class","num"),v.setAttribute("class","num"),K.setAttribute("class","num"),rowNas.appendChild(C),rowNas.appendChild(E),rowNas.appendChild(v),rowNas.appendChild(K)}).then(e=>{fetch(kumHarian).then(e=>e.json()).then(e=>{var t=e.features.filter(e=>e.attributes.Tanggal<new Date(Date.now()).getTime()&&null!==e.attributes.Jumlah_Kasus_Baru_per_Hari),a=t.map(function(e){return getShortDate(e.attributes.Tanggal)}),n=t.map(function(e){return e.attributes.Jumlah_Kasus_Baru_per_Hari}),r=document.getElementById("myChart").getContext("2d");new Chart(r,{type:"bar",data:{labels:a,datasets:[{label:"Penambahan Kasus",data:n,backgroundColor:"rgb(235, 247, 245)",borderColor:"rgb(0, 124, 145)",borderWidth:1}]},options:{axis:"y",responsive:!0,maintainAspectRatio:!1,title:{display:!0,text:"Grafik Penambahan Konfirmasi Kasus Positif per Hari"},scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}).catch(function(e){console.log(e)})}).then(e=>{fetch(perProv).then(e=>e.json()).then(function(e){let t=e.features;var a=t.reduce(function(e,t){return e+t.attributes.Kasus_Posi},0);if(console.log(a),console.log(globalVar.attributes.Jumlah_Kasus_Kumulatif),a<globalVar.attributes.Jumlah_Kasus_Kumulatif){let e=document.createElement("small");e.innerHTML="Data per Wilayah belum update. Terdapat perbedaan antara akumulasi data per wilayah dengan nasional.",document.getElementById("foot").appendChild(e)}else{let e=document.createElement("small");e.innerHTML="Data Nasional belum update. Terdapat perbedaan antara akumulasi data per wilayah dengan nasional.",document.getElementById("foot").appendChild(e)}return t.map(function(e){let t=document.createElement("tr"),a=document.createElement("td"),n=document.createElement("td"),r=document.createElement("td"),s=document.createElement("td");a.innerHTML=`${e.attributes.Provinsi}`,n.innerHTML=`${e.attributes.Kasus_Posi}`,r.innerHTML=`${e.attributes.Kasus_Semb}`,s.innerHTML=`${e.attributes.Kasus_Meni}`,a.setAttribute("class","prov"),n.setAttribute("class","num"),r.setAttribute("class","num"),s.setAttribute("class","num"),tableProv.appendChild(t),t.appendChild(a),t.appendChild(n),t.appendChild(r),t.appendChild(s)})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)});